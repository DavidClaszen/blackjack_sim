---
title: "Black Simulation Code Verification and Model Validation"
author: "David Claszen"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
library(tidyverse)
library(janitor)
source("play_blackjack.R")
```

# Model Validation

## Dealer Logic - Soft 17 Rules

A soft hand is a hand containing an ace that can still be either a 1 or an 11. A hard hand either holds no ace, or holds an ace that cannot be counted as 11 as it would push the total value above 21.

In blackjack, the dealer must draw cards until their hand achieves a total value of 17 or more. A common rule variation is whether the dealer must hit on a soft 17 (H17) or whether they can stand (S17). Having to hit on a soft 17 should result in fewer 17's, more values above 17, and more busts where the code counts the value as 0. The differences after 300.000 games for each variation are shown below, with each series of runs starting from the same seed. This will take about half a minute to run.




```{r}

```
```{r}

```




```{r}

test_1 <- replicate(1000, play_game(num_players = 1, initial_bet = 1, manual = FALSE, S_17 = TRUE, logic_board = lb_1))
test_2 <- replicate(100000, play_game(num_players = 1, initial_bet = 1, manual = FALSE, S_17 = FALSE, logic_board = lb_1))
Reduce("+", unlist(test_1, recursive = FALSE)[c(TRUE, FALSE)])
Reduce("+", unlist(test_2, recursive = FALSE)[c(TRUE, FALSE)])


table(unlist(unlist(test_1, recursive = TRUE)[c(TRUE, FALSE)]))
table(unlist(unlist(test_1, recursive = TRUE)[c(FALSE, TRUE)]))

table(unlist(unlist(test_2, recursive = TRUE)[c(TRUE, FALSE)]))
table(unlist(unlist(test_2, recursive = TRUE)[c(FALSE, TRUE)]))



unlist(unlist(test_1, recursive = TRUE)[c(TRUE, FALSE)])

```




```{r}




```





